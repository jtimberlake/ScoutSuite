{
  "description": "EC2 Instance with DynamoDB Management Permissions",
  "rationale": "Compute elements (EC2 instances, ECS containers, Lambda functions) must not have access to managerial actions such as creating/deleting tables, altering the backup settings, or altering the encryption properties of a table.",
  "references": [
    "https://zendesk.atlassian.net/wiki/spaces/SEC/pages/771261565/AWS+Service+Hardening+Guidelines#AWSServiceHardeningGuidelines-DynamoDB"
  ],
  "dashboard_name": "Instance Profiles",
  "remediation": "",
  "path": "iam.roles.id",
  "conditions": [
    "and",
    ["iam.roles.id.", "withKey", "inline_policies"],
    ["iam.roles.id.inline_policies", "notEmpty", ""],
    ["iam.roles.id.inline_policies.id.PolicyDocument.", "withKey", "Statement"],
    [
      "iam.roles.id.inline_policies.id.PolicyDocument.Statement.id.",
      "withKey",
      "Action"
    ],
    [
      "iam.roles.id.inline_policies.id.PolicyDocument.Statement.id.Action",
      "notEmpty",
      ""
    ],
    [
      "iam.roles.id.inline_policies.id.PolicyDocument.Statement.id.Action.",
      "containAtLeastOneOf",
      ["ec2:TerminateInstances"]
    ]
  ]
}
